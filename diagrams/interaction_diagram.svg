<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="2335px" preserveAspectRatio="none" style="width:1187px;height:2335px;" version="1.1" viewBox="0 0 1187 2335" width="1187px" zoomAndPan="magnify"><defs><filter height="300%" id="fxt3kyvuwv69q" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="985" x="94.5" y="28.708">Scenario: A Participant Is Consolidating 2 Coins (Alice1, Alice2) Into 1 (Bob) with a fake reissuance request</text><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="0" x="593" y="49.6611"/><rect fill="#FFFFFF" filter="url(#fxt3kyvuwv69q)" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="381" y="197.4688"/><rect fill="#FFFFFF" filter="url(#fxt3kyvuwv69q)" height="234.7266" style="stroke:#A80036;stroke-width:1.0;" width="10" x="381" y="255.7344"/><rect fill="#FFFFFF" filter="url(#fxt3kyvuwv69q)" height="143.9297" style="stroke:#A80036;stroke-width:1.0;" width="10" x="381" y="547.5938"/><rect fill="#FFFFFF" filter="url(#fxt3kyvuwv69q)" height="234.7266" style="stroke:#A80036;stroke-width:1.0;" width="10" x="381" y="720.6563"/><rect fill="#FFFFFF" filter="url(#fxt3kyvuwv69q)" height="128.7969" style="stroke:#A80036;stroke-width:1.0;" width="10" x="381" y="1027.6484"/><rect fill="#FFFFFF" filter="url(#fxt3kyvuwv69q)" height="128.7969" style="stroke:#A80036;stroke-width:1.0;" width="10" x="381" y="1185.5781"/><rect fill="#FFFFFF" filter="url(#fxt3kyvuwv69q)" height="113.6641" style="stroke:#A80036;stroke-width:1.0;" width="10" x="381" y="1343.5078"/><rect fill="#FFFFFF" filter="url(#fxt3kyvuwv69q)" height="128.7969" style="stroke:#A80036;stroke-width:1.0;" width="10" x="381" y="1529.4375"/><rect fill="#FFFFFF" filter="url(#fxt3kyvuwv69q)" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="381" y="1730.5"/><rect fill="#FFFFFF" filter="url(#fxt3kyvuwv69q)" height="128.7969" style="stroke:#A80036;stroke-width:1.0;" width="10" x="381" y="1788.7656"/><rect fill="#FFFFFF" filter="url(#fxt3kyvuwv69q)" height="128.7969" style="stroke:#A80036;stroke-width:1.0;" width="10" x="381" y="1946.6953"/><rect fill="#FFFFFF" filter="url(#fxt3kyvuwv69q)" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="381" y="2220.0547"/><line style="stroke:#A80036;stroke-width:1.0;" x1="46" x2="46" y1="123.2031" y2="498.4609"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="46" x2="46" y1="498.4609" y2="526.4609"/><line style="stroke:#A80036;stroke-width:1.0;" x1="46" x2="46" y1="526.4609" y2="2267.1875"/><line style="stroke:#A80036;stroke-width:1.0;" x1="386" x2="386" y1="123.2031" y2="498.4609"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="386" x2="386" y1="498.4609" y2="526.4609"/><line style="stroke:#A80036;stroke-width:1.0;" x1="386" x2="386" y1="526.4609" y2="2267.1875"/><line style="stroke:#A80036;stroke-width:1.0;" x1="933" x2="933" y1="123.2031" y2="498.4609"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="933" x2="933" y1="498.4609" y2="526.4609"/><line style="stroke:#A80036;stroke-width:1.0;" x1="933" x2="933" y1="526.4609" y2="2267.1875"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1004" x2="1004" y1="123.2031" y2="498.4609"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="1004" x2="1004" y1="498.4609" y2="526.4609"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1004" x2="1004" y1="526.4609" y2="2267.1875"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1068" x2="1068" y1="123.2031" y2="498.4609"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="1068" x2="1068" y1="498.4609" y2="526.4609"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1068" x2="1068" y1="526.4609" y2="2267.1875"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1138" x2="1138" y1="2172.7734" y2="2267.1875"/><rect fill="#FEFECE" filter="url(#fxt3kyvuwv69q)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="74" x="9" y="83.9063"/><rect fill="#FEFECE" filter="url(#fxt3kyvuwv69q)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="74" x="5" y="87.9063"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="60" x="12" y="107.9014">Satoshis</text><rect fill="#FEFECE" filter="url(#fxt3kyvuwv69q)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="74" x="9" y="2266.1875"/><rect fill="#FEFECE" filter="url(#fxt3kyvuwv69q)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="74" x="5" y="2270.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="60" x="12" y="2290.1826">Satoshis</text><rect fill="#FEFECE" filter="url(#fxt3kyvuwv69q)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="100" x="334" y="87.9063"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="86" x="341" y="107.9014">Coordinator</text><rect fill="#FEFECE" filter="url(#fxt3kyvuwv69q)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="100" x="334" y="2266.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="86" x="341" y="2286.1826">Coordinator</text><rect fill="#FEFECE" filter="url(#fxt3kyvuwv69q)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="58" x="902" y="87.9063"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44" x="909" y="107.9014">Alice1</text><rect fill="#FEFECE" filter="url(#fxt3kyvuwv69q)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="58" x="902" y="2266.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44" x="909" y="2286.1826">Alice1</text><rect fill="#FEFECE" filter="url(#fxt3kyvuwv69q)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="57" x="974" y="87.9063"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="43" x="981" y="107.9014">Alice2</text><rect fill="#FEFECE" filter="url(#fxt3kyvuwv69q)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="57" x="974" y="2266.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="43" x="981" y="2286.1826">Alice2</text><rect fill="#FEFECE" filter="url(#fxt3kyvuwv69q)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="43" x="1045" y="87.9063"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29" x="1052" y="107.9014">Bob</text><rect fill="#FEFECE" filter="url(#fxt3kyvuwv69q)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="43" x="1045" y="2266.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29" x="1052" y="2286.1826">Bob</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="67" x="1102" y="2279.1826">Mempool</text><path d="M1120.5,2292.4844 C1120.5,2282.4844 1138.5,2282.4844 1138.5,2282.4844 C1138.5,2282.4844 1156.5,2282.4844 1156.5,2292.4844 L1156.5,2318.4844 C1156.5,2328.4844 1138.5,2328.4844 1138.5,2328.4844 C1138.5,2328.4844 1120.5,2328.4844 1120.5,2318.4844 L1120.5,2292.4844 " fill="#FEFECE" filter="url(#fxt3kyvuwv69q)" style="stroke:#000000;stroke-width:1.5;"/><path d="M1120.5,2292.4844 C1120.5,2302.4844 1138.5,2302.4844 1138.5,2302.4844 C1138.5,2302.4844 1156.5,2302.4844 1156.5,2292.4844 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><rect fill="#FFFFFF" filter="url(#fxt3kyvuwv69q)" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="381" y="197.4688"/><rect fill="#FFFFFF" filter="url(#fxt3kyvuwv69q)" height="234.7266" style="stroke:#A80036;stroke-width:1.0;" width="10" x="381" y="255.7344"/><rect fill="#FFFFFF" filter="url(#fxt3kyvuwv69q)" height="143.9297" style="stroke:#A80036;stroke-width:1.0;" width="10" x="381" y="547.5938"/><rect fill="#FFFFFF" filter="url(#fxt3kyvuwv69q)" height="234.7266" style="stroke:#A80036;stroke-width:1.0;" width="10" x="381" y="720.6563"/><rect fill="#FFFFFF" filter="url(#fxt3kyvuwv69q)" height="128.7969" style="stroke:#A80036;stroke-width:1.0;" width="10" x="381" y="1027.6484"/><rect fill="#FFFFFF" filter="url(#fxt3kyvuwv69q)" height="128.7969" style="stroke:#A80036;stroke-width:1.0;" width="10" x="381" y="1185.5781"/><rect fill="#FFFFFF" filter="url(#fxt3kyvuwv69q)" height="113.6641" style="stroke:#A80036;stroke-width:1.0;" width="10" x="381" y="1343.5078"/><rect fill="#FFFFFF" filter="url(#fxt3kyvuwv69q)" height="128.7969" style="stroke:#A80036;stroke-width:1.0;" width="10" x="381" y="1529.4375"/><rect fill="#FFFFFF" filter="url(#fxt3kyvuwv69q)" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="381" y="1730.5"/><rect fill="#FFFFFF" filter="url(#fxt3kyvuwv69q)" height="128.7969" style="stroke:#A80036;stroke-width:1.0;" width="10" x="381" y="1788.7656"/><rect fill="#FFFFFF" filter="url(#fxt3kyvuwv69q)" height="128.7969" style="stroke:#A80036;stroke-width:1.0;" width="10" x="381" y="1946.6953"/><rect fill="#FFFFFF" filter="url(#fxt3kyvuwv69q)" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="381" y="2220.0547"/><rect fill="#EEEEEE" filter="url(#fxt3kyvuwv69q)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1180" x="0" y="153.7695"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1180" y1="153.7695" y2="153.7695"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1180" y1="156.7695" y2="156.7695"/><rect fill="#EEEEEE" filter="url(#fxt3kyvuwv69q)" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="159" x="510.5" y="143.2031"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="140" x="516.5" y="159.27">Input Registration</text><polygon fill="#A80036" points="369,193.4688,379,197.4688,369,201.4688,373,197.4688" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="46" x2="375" y1="197.4688" y2="197.4688"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148" x="53" y="192.4028">GET coordinator-status</text><polygon fill="#A80036" points="57,222.6016,47,226.6016,57,230.6016,53,226.6016" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="51" x2="385" y1="226.6016" y2="226.6016"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107" x="63" y="221.5356">RoundStatuses[]</text><polygon fill="#A80036" points="402,251.7344,392,255.7344,402,259.7344,398,255.7344" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="396" x2="932" y1="255.7344" y2="255.7344"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="497" x="408" y="250.6685">POST inputs-registration: RoundId, (Input, RoundParamSig)[], ZeroCredReqs[]</text><path d="M396,268.7344 L396,459.7344 L585,459.7344 L585,278.7344 L575,268.7344 L396,268.7344 " fill="#FBFB77" filter="url(#fxt3kyvuwv69q)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M575,268.7344 L575,278.7344 L585,278.7344 L575,268.7344 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100" x="402" y="285.8013">IsRoundFound()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="168" x="402" y="300.9341">IsInputRegistrationPhase()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="402" y="316.0669">AllUnspent()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92" x="402" y="331.1997">AllConfirmed()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69" x="402" y="346.3325">AllMature()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="119" x="402" y="361.4653">AllStandardScript()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="402" y="376.5981">AllNotMalleable()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="158" x="402" y="391.731">CheckRoundParamSigs()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164" x="402" y="406.8638">AllAllowedIfBlameRound()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95" x="402" y="421.9966">AllNotBanned()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156" x="402" y="437.1294">UpdateIfDuplicateInput()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117" x="402" y="452.2622">SetAliceDeadline()</text><polygon fill="#A80036" points="921,486.4609,931,490.4609,921,494.4609,925,490.4609" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="386" x2="927" y1="490.4609" y2="490.4609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127" x="393" y="485.395">AliceId, ZeroCreds[]</text><polygon fill="#A80036" points="402,543.5938,392,547.5938,402,551.5938,398,547.5938" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="396" x2="932" y1="547.5938" y2="547.5938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="523" x="408" y="542.5278">POST connection-confirmation: RoundId, AliceId, RealCredReqs[], ZeroCredReqs[]</text><path d="M396,560.5938 L396,660.5938 L755,660.5938 L755,570.5938 L745,560.5938 L396,560.5938 " fill="#FBFB77" filter="url(#fxt3kyvuwv69q)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M745,560.5938 L745,570.5938 L755,570.5938 L745,560.5938 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100" x="402" y="577.6606">IsRoundFound()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="338" x="402" y="592.7935">IsInputRegistrationOrConnectionConfirmationPhase()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89" x="402" y="607.9263">IsAliceFound()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="184" x="402" y="623.0591">EnsureUniqueSerialNumber()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120" x="402" y="638.1919">CheckCredProofs()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133" x="402" y="653.3247">ResetAliceDeadline()</text><polygon fill="#A80036" points="921,687.5234,931,691.5234,921,695.5234,925,691.5234" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="386" x2="927" y1="691.5234" y2="691.5234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89" x="393" y="686.4575">Creds[] (zero)</text><polygon fill="#A80036" points="402,716.6563,392,720.6563,402,724.6563,398,720.6563" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="396" x2="1003.5" y1="720.6563" y2="720.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="497" x="408" y="715.5903">POST inputs-registration: RoundId, (Input, RoundParamSig)[], ZeroCredReqs[]</text><path d="M396,733.6563 L396,924.6563 L585,924.6563 L585,743.6563 L575,733.6563 L396,733.6563 " fill="#FBFB77" filter="url(#fxt3kyvuwv69q)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M575,733.6563 L575,743.6563 L585,743.6563 L575,733.6563 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100" x="402" y="750.7231">IsRoundFound()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="168" x="402" y="765.856">IsInputRegistrationPhase()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="402" y="780.9888">AllUnspent()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92" x="402" y="796.1216">AllConfirmed()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69" x="402" y="811.2544">AllMature()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="119" x="402" y="826.3872">AllStandardScript()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="402" y="841.52">AllNotMalleable()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="158" x="402" y="856.6528">CheckRoundParamSigs()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164" x="402" y="871.7856">AllAllowedIfBlameRound()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95" x="402" y="886.9185">AllNotBanned()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156" x="402" y="902.0513">UpdateIfDuplicateInput()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117" x="402" y="917.1841">SetAliceDeadline()</text><polygon fill="#A80036" points="992.5,951.3828,1002.5,955.3828,992.5,959.3828,996.5,955.3828" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="386" x2="998.5" y1="955.3828" y2="955.3828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127" x="393" y="950.3169">AliceId, ZeroCreds[]</text><rect fill="#EEEEEE" filter="url(#fxt3kyvuwv69q)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1180" x="0" y="983.9492"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1180" y1="983.9492" y2="983.9492"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1180" y1="986.9492" y2="986.9492"/><rect fill="#EEEEEE" filter="url(#fxt3kyvuwv69q)" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="211" x="484.5" y="973.3828"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="192" x="490.5" y="989.4497">Connection Confirmation</text><polygon fill="#A80036" points="402,1023.6484,392,1027.6484,402,1031.6484,398,1027.6484" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="396" x2="932" y1="1027.6484" y2="1027.6484"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="523" x="408" y="1022.5825">POST connection-confirmation: RoundId, AliceId, RealCredReqs[], ZeroCredReqs[]</text><path d="M396,1040.6484 L396,1125.6484 L755,1125.6484 L755,1050.6484 L745,1040.6484 L396,1040.6484 " fill="#FBFB77" filter="url(#fxt3kyvuwv69q)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M745,1040.6484 L745,1050.6484 L755,1050.6484 L745,1040.6484 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100" x="402" y="1057.7153">IsRoundFound()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="338" x="402" y="1072.8481">IsInputRegistrationOrConnectionConfirmationPhase()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89" x="402" y="1087.981">IsAliceFound()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="184" x="402" y="1103.1138">EnsureUniqueSerialNumber()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120" x="402" y="1118.2466">CheckCredProofs()</text><polygon fill="#A80036" points="921,1152.4453,931,1156.4453,921,1160.4453,925,1156.4453" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="386" x2="927" y1="1156.4453" y2="1156.4453"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="85" x="393" y="1151.3794">Creds[] (real)</text><polygon fill="#A80036" points="402,1181.5781,392,1185.5781,402,1189.5781,398,1185.5781" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="396" x2="1003.5" y1="1185.5781" y2="1185.5781"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="523" x="408" y="1180.5122">POST connection-confirmation: RoundId, AliceId, RealCredReqs[], ZeroCredReqs[]</text><path d="M396,1198.5781 L396,1283.5781 L755,1283.5781 L755,1208.5781 L745,1198.5781 L396,1198.5781 " fill="#FBFB77" filter="url(#fxt3kyvuwv69q)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M745,1198.5781 L745,1208.5781 L755,1208.5781 L745,1198.5781 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100" x="402" y="1215.645">IsRoundFound()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="338" x="402" y="1230.7778">IsInputRegistrationOrConnectionConfirmationPhase()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89" x="402" y="1245.9106">IsAliceFound()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="184" x="402" y="1261.0435">EnsureUniqueSerialNumber()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120" x="402" y="1276.1763">CheckCredProofs()</text><polygon fill="#A80036" points="992.5,1310.375,1002.5,1314.375,992.5,1318.375,996.5,1314.375" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="386" x2="998.5" y1="1314.375" y2="1314.375"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="85" x="393" y="1309.3091">Creds[] (real)</text><polygon fill="#A80036" points="369,1339.5078,379,1343.5078,369,1347.5078,373,1343.5078" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="46" x2="375" y1="1343.5078" y2="1343.5078"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="316" x="53" y="1338.4419">POST credential-reissuance: RoundId, CredReqs[]</text><path d="M396,1356.5078 L396,1426.5078 L799,1426.5078 L799,1366.5078 L789,1356.5078 L396,1356.5078 " fill="#FBFB77" filter="url(#fxt3kyvuwv69q)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M789,1356.5078 L789,1366.5078 L799,1366.5078 L789,1356.5078 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100" x="402" y="1373.5747">IsRoundFound()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="382" x="402" y="1388.7075">IsInputConnectionConfirmationOrOutputRegistrationPhase()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="184" x="402" y="1403.8403">EnsureUniqueSerialNumber()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120" x="402" y="1418.9731">CheckCredProofs()</text><polygon fill="#A80036" points="57,1453.1719,47,1457.1719,57,1461.1719,53,1457.1719" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="51" x2="385" y1="1457.1719" y2="1457.1719"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="47" x="63" y="1452.106">Creds[]</text><rect fill="#EEEEEE" filter="url(#fxt3kyvuwv69q)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1180" x="0" y="1485.7383"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1180" y1="1485.7383" y2="1485.7383"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1180" y1="1488.7383" y2="1488.7383"/><rect fill="#EEEEEE" filter="url(#fxt3kyvuwv69q)" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="173" x="503.5" y="1475.1719"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="154" x="509.5" y="1491.2388">Output Registration</text><polygon fill="#A80036" points="402,1525.4375,392,1529.4375,402,1533.4375,398,1529.4375" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="396" x2="1067.5" y1="1529.4375" y2="1529.4375"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="391" x="408" y="1524.3716">POST output-registration: RoundId, Output, PresentedCreds[]</text><path d="M396,1542.4375 L396,1627.4375 L601,1627.4375 L601,1552.4375 L591,1542.4375 L396,1542.4375 " fill="#FBFB77" filter="url(#fxt3kyvuwv69q)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M591,1542.4375 L591,1552.4375 L601,1552.4375 L591,1542.4375 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100" x="402" y="1559.5044">IsRoundFound()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180" x="402" y="1574.6372">IsOutputRegistrationPhase()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114" x="402" y="1589.77">IsStandardScript()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="184" x="402" y="1604.9028">EnsureUniqueSerialNumber()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120" x="402" y="1620.0356">CheckCredProofs()</text><polygon fill="#A80036" points="1056.5,1654.2344,1066.5,1658.2344,1056.5,1662.2344,1060.5,1658.2344" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="386" x2="1062.5" y1="1658.2344" y2="1658.2344"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="175" x="393" y="1653.1685">UnsignedTransactionSecret</text><rect fill="#EEEEEE" filter="url(#fxt3kyvuwv69q)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1180" x="0" y="1686.8008"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1180" y1="1686.8008" y2="1686.8008"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1180" y1="1689.8008" y2="1689.8008"/><rect fill="#EEEEEE" filter="url(#fxt3kyvuwv69q)" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="169" x="505.5" y="1676.2344"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="150" x="511.5" y="1692.3013">Transaction Signing</text><polygon fill="#A80036" points="369,1726.5,379,1730.5,369,1734.5,373,1730.5" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="46" x2="375" y1="1730.5" y2="1730.5"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118" x="53" y="1725.4341">coordinator-status</text><polygon fill="#A80036" points="57,1755.6328,47,1759.6328,57,1763.6328,53,1759.6328" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="51" x2="385" y1="1759.6328" y2="1759.6328"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107" x="63" y="1754.5669">RoundStatuses[]</text><polygon fill="#A80036" points="402,1784.7656,392,1788.7656,402,1792.7656,398,1788.7656" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="396" x2="932" y1="1788.7656" y2="1788.7656"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="421" x="408" y="1783.6997">POST transaction-signatures: RoundId, AliceId, (Input, Signature)[]</text><path d="M396,1801.7656 L396,1886.7656 L597,1886.7656 L597,1811.7656 L587,1801.7656 L396,1801.7656 " fill="#FBFB77" filter="url(#fxt3kyvuwv69q)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M587,1801.7656 L587,1811.7656 L597,1811.7656 L587,1801.7656 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100" x="402" y="1818.8325">IsRoundFound()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180" x="402" y="1833.9653">IsTransactionSigningPhase()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89" x="402" y="1849.0981">IsAliceFound()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="149" x="402" y="1864.231">CheckInputSignatures()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156" x="402" y="1879.3638">UpdateIfAlreadySigned()</text><polygon fill="#A80036" points="921,1913.5625,931,1917.5625,921,1921.5625,925,1917.5625" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="386" x2="927" y1="1917.5625" y2="1917.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="26" x="393" y="1912.4966">ACK</text><polygon fill="#A80036" points="402,1942.6953,392,1946.6953,402,1950.6953,398,1946.6953" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="396" x2="1003.5" y1="1946.6953" y2="1946.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="421" x="408" y="1941.6294">POST transaction-signatures: RoundId, AliceId, (Input, Signature)[]</text><path d="M396,1959.6953 L396,2044.6953 L597,2044.6953 L597,1969.6953 L587,1959.6953 L396,1959.6953 " fill="#FBFB77" filter="url(#fxt3kyvuwv69q)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M587,1959.6953 L587,1969.6953 L597,1969.6953 L587,1959.6953 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100" x="402" y="1976.7622">IsRoundFound()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180" x="402" y="1991.895">IsTransactionSigningPhase()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89" x="402" y="2007.0278">IsAliceFound()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="149" x="402" y="2022.1606">CheckInputSignatures()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156" x="402" y="2037.2935">UpdateIfAlreadySigned()</text><polygon fill="#A80036" points="992.5,2071.4922,1002.5,2075.4922,992.5,2079.4922,996.5,2075.4922" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="386" x2="998.5" y1="2075.4922" y2="2075.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="26" x="393" y="2070.4263">ACK</text><rect fill="#EEEEEE" filter="url(#fxt3kyvuwv69q)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1180" x="0" y="2104.0586"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1180" y1="2104.0586" y2="2104.0586"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1180" y1="2107.0586" y2="2107.0586"/><rect fill="#EEEEEE" filter="url(#fxt3kyvuwv69q)" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="216" x="482" y="2093.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="197" x="488" y="2109.5591">Transaction Broadcasting</text><polygon fill="#A80036" points="1090,2143.7578,1100,2147.7578,1090,2151.7578,1094,2147.7578" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="386" x2="1096" y1="2147.7578" y2="2147.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118" x="393" y="2142.6919">SignedTransaction</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="67" x="1102" y="2185.6201">Mempool</text><path d="M1120.5,2136.625 C1120.5,2126.625 1138.5,2126.625 1138.5,2126.625 C1138.5,2126.625 1156.5,2126.625 1156.5,2136.625 L1156.5,2162.625 C1156.5,2172.625 1138.5,2172.625 1138.5,2172.625 C1138.5,2172.625 1120.5,2172.625 1120.5,2162.625 L1120.5,2136.625 " fill="#FEFECE" filter="url(#fxt3kyvuwv69q)" style="stroke:#000000;stroke-width:1.5;"/><path d="M1120.5,2136.625 C1120.5,2146.625 1138.5,2146.625 1138.5,2146.625 C1138.5,2146.625 1156.5,2146.625 1156.5,2136.625 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><polygon fill="#A80036" points="369,2216.0547,379,2220.0547,369,2224.0547,373,2220.0547" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="46" x2="375" y1="2220.0547" y2="2220.0547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118" x="53" y="2214.9888">coordinator-status</text><polygon fill="#A80036" points="57,2245.1875,47,2249.1875,57,2253.1875,53,2249.1875" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="51" x2="385" y1="2249.1875" y2="2249.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107" x="63" y="2244.1216">RoundStatuses[]</text><!--MD5=[6c989570566627523f9e14e1d3454207]
@startuml
collections Satoshis
participant Coordinator
participant Alice1
participant Alice2
participant Bob
database Mempool

title Scenario: A Participant Is Consolidating 2 Coins (Alice1, Alice2) Into 1 (Bob) with a fake reissuance request \n

== Input Registration ==

Satoshis -> Coordinator ++ : GET coordinator-status
return RoundStatuses[]

Alice1 -> Coordinator ++: POST inputs-registration: RoundId, (Input, RoundParamSig)[], ZeroCredReqs[]
note right of Coordinator
    IsRoundFound()
    IsInputRegistrationPhase()
    AllUnspent()
    AllConfirmed()
    AllMature()
    AllStandardScript()
    AllNotMalleable()
    CheckRoundParamSigs()
    AllAllowedIfBlameRound()
    AllNotBanned()
    UpdateIfDuplicateInput()
    SetAliceDeadline()
end note
return AliceId, ZeroCreds[]
...

Alice1 -> Coordinator ++: POST connection-confirmation: RoundId, AliceId, RealCredReqs[], ZeroCredReqs[]
note right of Coordinator
    IsRoundFound()
    IsInputRegistrationOrConnectionConfirmationPhase()
    IsAliceFound()
    EnsureUniqueSerialNumber()
    CheckCredProofs()
    ResetAliceDeadline()
end note
return Creds[] (zero)

Alice2 -> Coordinator ++: POST inputs-registration: RoundId, (Input, RoundParamSig)[], ZeroCredReqs[]
note right of Coordinator
    IsRoundFound()
    IsInputRegistrationPhase()
    AllUnspent()
    AllConfirmed()
    AllMature()
    AllStandardScript()
    AllNotMalleable()
    CheckRoundParamSigs()
    AllAllowedIfBlameRound()
    AllNotBanned()
    UpdateIfDuplicateInput()
    SetAliceDeadline()
end note
return AliceId, ZeroCreds[]

== Connection Confirmation ==

Alice1 -> Coordinator ++: POST connection-confirmation: RoundId, AliceId, RealCredReqs[], ZeroCredReqs[]
note right of Coordinator
    IsRoundFound()
    IsInputRegistrationOrConnectionConfirmationPhase()
    IsAliceFound()
    EnsureUniqueSerialNumber()
    CheckCredProofs()
end note
return Creds[] (real)

Alice2 -> Coordinator ++: POST connection-confirmation: RoundId, AliceId, RealCredReqs[], ZeroCredReqs[]
note right of Coordinator
    IsRoundFound()
    IsInputRegistrationOrConnectionConfirmationPhase()
    IsAliceFound()
    EnsureUniqueSerialNumber()
    CheckCredProofs()
end note
return Creds[] (real)

Satoshis -> Coordinator ++: POST credential-reissuance: RoundId, CredReqs[]
note right of Coordinator
    IsRoundFound()
    IsInputConnectionConfirmationOrOutputRegistrationPhase()
    EnsureUniqueSerialNumber()
    CheckCredProofs()
end note
return Creds[]

== Output Registration ==

Bob -> Coordinator ++: POST output-registration: RoundId, Output, PresentedCreds[]
note right of Coordinator
    IsRoundFound()
    IsOutputRegistrationPhase()
    IsStandardScript()
    EnsureUniqueSerialNumber()
    CheckCredProofs()
end note
return UnsignedTransactionSecret

== Transaction Signing ==

Satoshis -> Coordinator ++ : coordinator-status
return RoundStatuses[]

Alice1 -> Coordinator ++: POST transaction-signatures: RoundId, AliceId, (Input, Signature)[]
note right of Coordinator
    IsRoundFound()
    IsTransactionSigningPhase()
    IsAliceFound()
    CheckInputSignatures()
    UpdateIfAlreadySigned()
end note
return ACK

Alice2 -> Coordinator ++: POST transaction-signatures: RoundId, AliceId, (Input, Signature)[]
note right of Coordinator
    IsRoundFound()
    IsTransactionSigningPhase()
    IsAliceFound()
    CheckInputSignatures()
    UpdateIfAlreadySigned()
end note
return ACK

== Transaction Broadcasting ==

Coordinator -> Mempool**  : SignedTransaction

Satoshis -> Coordinator ++ : coordinator-status
return RoundStatuses[]
@enduml

PlantUML version 1.2021.2beta2(Unknown compile time)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>