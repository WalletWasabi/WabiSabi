<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="2335px" preserveAspectRatio="none" style="width:1198px;height:2335px;" version="1.1" viewBox="0 0 1198 2335" width="1198px" zoomAndPan="magnify"><defs><filter height="300%" id="fqyzb78sj8d8t" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="985" x="100.25" y="28.708">Scenario: A Participant Is Consolidating 2 Coins (Alice1, Alice2) Into 1 (Bob) with a fake reissuance request</text><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="0" x="598.75" y="49.6611"/><rect fill="#FFFFFF" filter="url(#fqyzb78sj8d8t)" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="392.5" y="197.4688"/><rect fill="#FFFFFF" filter="url(#fqyzb78sj8d8t)" height="234.7266" style="stroke:#A80036;stroke-width:1.0;" width="10" x="392.5" y="255.7344"/><rect fill="#FFFFFF" filter="url(#fqyzb78sj8d8t)" height="143.9297" style="stroke:#A80036;stroke-width:1.0;" width="10" x="392.5" y="547.5938"/><rect fill="#FFFFFF" filter="url(#fqyzb78sj8d8t)" height="234.7266" style="stroke:#A80036;stroke-width:1.0;" width="10" x="392.5" y="720.6563"/><rect fill="#FFFFFF" filter="url(#fqyzb78sj8d8t)" height="128.7969" style="stroke:#A80036;stroke-width:1.0;" width="10" x="392.5" y="1027.6484"/><rect fill="#FFFFFF" filter="url(#fqyzb78sj8d8t)" height="128.7969" style="stroke:#A80036;stroke-width:1.0;" width="10" x="392.5" y="1185.5781"/><rect fill="#FFFFFF" filter="url(#fqyzb78sj8d8t)" height="113.6641" style="stroke:#A80036;stroke-width:1.0;" width="10" x="392.5" y="1343.5078"/><rect fill="#FFFFFF" filter="url(#fqyzb78sj8d8t)" height="128.7969" style="stroke:#A80036;stroke-width:1.0;" width="10" x="392.5" y="1529.4375"/><rect fill="#FFFFFF" filter="url(#fqyzb78sj8d8t)" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="392.5" y="1730.5"/><rect fill="#FFFFFF" filter="url(#fqyzb78sj8d8t)" height="128.7969" style="stroke:#A80036;stroke-width:1.0;" width="10" x="392.5" y="1788.7656"/><rect fill="#FFFFFF" filter="url(#fqyzb78sj8d8t)" height="128.7969" style="stroke:#A80036;stroke-width:1.0;" width="10" x="392.5" y="1946.6953"/><rect fill="#FFFFFF" filter="url(#fqyzb78sj8d8t)" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="392.5" y="2220.0547"/><line style="stroke:#A80036;stroke-width:1.0;" x1="57" x2="57" y1="123.2031" y2="498.4609"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="57" x2="57" y1="498.4609" y2="526.4609"/><line style="stroke:#A80036;stroke-width:1.0;" x1="57" x2="57" y1="526.4609" y2="2267.1875"/><line style="stroke:#A80036;stroke-width:1.0;" x1="397.5" x2="397.5" y1="123.2031" y2="498.4609"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="397.5" x2="397.5" y1="498.4609" y2="526.4609"/><line style="stroke:#A80036;stroke-width:1.0;" x1="397.5" x2="397.5" y1="526.4609" y2="2267.1875"/><line style="stroke:#A80036;stroke-width:1.0;" x1="944.5" x2="944.5" y1="123.2031" y2="498.4609"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="944.5" x2="944.5" y1="498.4609" y2="526.4609"/><line style="stroke:#A80036;stroke-width:1.0;" x1="944.5" x2="944.5" y1="526.4609" y2="2267.1875"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1015.5" x2="1015.5" y1="123.2031" y2="498.4609"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="1015.5" x2="1015.5" y1="498.4609" y2="526.4609"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1015.5" x2="1015.5" y1="526.4609" y2="2267.1875"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1079.5" x2="1079.5" y1="123.2031" y2="498.4609"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="1079.5" x2="1079.5" y1="498.4609" y2="526.4609"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1079.5" x2="1079.5" y1="526.4609" y2="2267.1875"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1149.5" x2="1149.5" y1="2172.7734" y2="2267.1875"/><rect fill="#FEFECE" filter="url(#fqyzb78sj8d8t)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="97" x="9" y="83.9063"/><rect fill="#FEFECE" filter="url(#fqyzb78sj8d8t)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="97" x="5" y="87.9063"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="83" x="12" y="107.9014">Anonymous</text><rect fill="#FEFECE" filter="url(#fqyzb78sj8d8t)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="97" x="9" y="2266.1875"/><rect fill="#FEFECE" filter="url(#fqyzb78sj8d8t)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="97" x="5" y="2270.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="83" x="12" y="2290.1826">Anonymous</text><rect fill="#FEFECE" filter="url(#fqyzb78sj8d8t)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="100" x="345.5" y="87.9063"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="86" x="352.5" y="107.9014">Coordinator</text><rect fill="#FEFECE" filter="url(#fqyzb78sj8d8t)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="100" x="345.5" y="2266.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="86" x="352.5" y="2286.1826">Coordinator</text><rect fill="#FEFECE" filter="url(#fqyzb78sj8d8t)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="58" x="913.5" y="87.9063"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44" x="920.5" y="107.9014">Alice1</text><rect fill="#FEFECE" filter="url(#fqyzb78sj8d8t)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="58" x="913.5" y="2266.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44" x="920.5" y="2286.1826">Alice1</text><rect fill="#FEFECE" filter="url(#fqyzb78sj8d8t)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="57" x="985.5" y="87.9063"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="43" x="992.5" y="107.9014">Alice2</text><rect fill="#FEFECE" filter="url(#fqyzb78sj8d8t)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="57" x="985.5" y="2266.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="43" x="992.5" y="2286.1826">Alice2</text><rect fill="#FEFECE" filter="url(#fqyzb78sj8d8t)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="43" x="1056.5" y="87.9063"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29" x="1063.5" y="107.9014">Bob</text><rect fill="#FEFECE" filter="url(#fqyzb78sj8d8t)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="43" x="1056.5" y="2266.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29" x="1063.5" y="2286.1826">Bob</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="67" x="1113.5" y="2279.1826">Mempool</text><path d="M1132,2292.4844 C1132,2282.4844 1150,2282.4844 1150,2282.4844 C1150,2282.4844 1168,2282.4844 1168,2292.4844 L1168,2318.4844 C1168,2328.4844 1150,2328.4844 1150,2328.4844 C1150,2328.4844 1132,2328.4844 1132,2318.4844 L1132,2292.4844 " fill="#FEFECE" filter="url(#fqyzb78sj8d8t)" style="stroke:#000000;stroke-width:1.5;"/><path d="M1132,2292.4844 C1132,2302.4844 1150,2302.4844 1150,2302.4844 C1150,2302.4844 1168,2302.4844 1168,2292.4844 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><rect fill="#FFFFFF" filter="url(#fqyzb78sj8d8t)" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="392.5" y="197.4688"/><rect fill="#FFFFFF" filter="url(#fqyzb78sj8d8t)" height="234.7266" style="stroke:#A80036;stroke-width:1.0;" width="10" x="392.5" y="255.7344"/><rect fill="#FFFFFF" filter="url(#fqyzb78sj8d8t)" height="143.9297" style="stroke:#A80036;stroke-width:1.0;" width="10" x="392.5" y="547.5938"/><rect fill="#FFFFFF" filter="url(#fqyzb78sj8d8t)" height="234.7266" style="stroke:#A80036;stroke-width:1.0;" width="10" x="392.5" y="720.6563"/><rect fill="#FFFFFF" filter="url(#fqyzb78sj8d8t)" height="128.7969" style="stroke:#A80036;stroke-width:1.0;" width="10" x="392.5" y="1027.6484"/><rect fill="#FFFFFF" filter="url(#fqyzb78sj8d8t)" height="128.7969" style="stroke:#A80036;stroke-width:1.0;" width="10" x="392.5" y="1185.5781"/><rect fill="#FFFFFF" filter="url(#fqyzb78sj8d8t)" height="113.6641" style="stroke:#A80036;stroke-width:1.0;" width="10" x="392.5" y="1343.5078"/><rect fill="#FFFFFF" filter="url(#fqyzb78sj8d8t)" height="128.7969" style="stroke:#A80036;stroke-width:1.0;" width="10" x="392.5" y="1529.4375"/><rect fill="#FFFFFF" filter="url(#fqyzb78sj8d8t)" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="392.5" y="1730.5"/><rect fill="#FFFFFF" filter="url(#fqyzb78sj8d8t)" height="128.7969" style="stroke:#A80036;stroke-width:1.0;" width="10" x="392.5" y="1788.7656"/><rect fill="#FFFFFF" filter="url(#fqyzb78sj8d8t)" height="128.7969" style="stroke:#A80036;stroke-width:1.0;" width="10" x="392.5" y="1946.6953"/><rect fill="#FFFFFF" filter="url(#fqyzb78sj8d8t)" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="392.5" y="2220.0547"/><rect fill="#EEEEEE" filter="url(#fqyzb78sj8d8t)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1191.5" x="0" y="153.7695"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1191.5" y1="153.7695" y2="153.7695"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1191.5" y1="156.7695" y2="156.7695"/><rect fill="#EEEEEE" filter="url(#fqyzb78sj8d8t)" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="159" x="516.25" y="143.2031"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="140" x="522.25" y="159.27">Input Registration</text><polygon fill="#A80036" points="380.5,193.4688,390.5,197.4688,380.5,201.4688,384.5,197.4688" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="57.5" x2="386.5" y1="197.4688" y2="197.4688"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148" x="64.5" y="192.4028">GET coordinator-status</text><polygon fill="#A80036" points="68.5,222.6016,58.5,226.6016,68.5,230.6016,64.5,226.6016" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="62.5" x2="396.5" y1="226.6016" y2="226.6016"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107" x="74.5" y="221.5356">RoundStatuses[]</text><polygon fill="#A80036" points="413.5,251.7344,403.5,255.7344,413.5,259.7344,409.5,255.7344" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="407.5" x2="943.5" y1="255.7344" y2="255.7344"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="497" x="419.5" y="250.6685">POST inputs-registration: RoundId, (Input, RoundParamSig)[], ZeroCredReqs[]</text><path d="M407,268.7344 L407,459.7344 L596,459.7344 L596,278.7344 L586,268.7344 L407,268.7344 " fill="#FBFB77" filter="url(#fqyzb78sj8d8t)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M586,268.7344 L586,278.7344 L596,278.7344 L586,268.7344 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100" x="413" y="285.8013">IsRoundFound()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="168" x="413" y="300.9341">IsInputRegistrationPhase()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="413" y="316.0669">AllUnspent()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92" x="413" y="331.1997">AllConfirmed()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69" x="413" y="346.3325">AllMature()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="119" x="413" y="361.4653">AllStandardScript()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="413" y="376.5981">AllNotMalleable()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="158" x="413" y="391.731">CheckRoundParamSigs()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164" x="413" y="406.8638">AllAllowedIfBlameRound()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95" x="413" y="421.9966">AllNotBanned()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156" x="413" y="437.1294">UpdateIfDuplicateInput()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117" x="413" y="452.2622">SetAliceDeadline()</text><polygon fill="#A80036" points="932.5,486.4609,942.5,490.4609,932.5,494.4609,936.5,490.4609" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="397.5" x2="938.5" y1="490.4609" y2="490.4609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127" x="404.5" y="485.395">AliceId, ZeroCreds[]</text><polygon fill="#A80036" points="413.5,543.5938,403.5,547.5938,413.5,551.5938,409.5,547.5938" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="407.5" x2="943.5" y1="547.5938" y2="547.5938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="523" x="419.5" y="542.5278">POST connection-confirmation: RoundId, AliceId, RealCredReqs[], ZeroCredReqs[]</text><path d="M407,560.5938 L407,660.5938 L766,660.5938 L766,570.5938 L756,560.5938 L407,560.5938 " fill="#FBFB77" filter="url(#fqyzb78sj8d8t)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M756,560.5938 L756,570.5938 L766,570.5938 L756,560.5938 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100" x="413" y="577.6606">IsRoundFound()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="338" x="413" y="592.7935">IsInputRegistrationOrConnectionConfirmationPhase()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89" x="413" y="607.9263">IsAliceFound()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="184" x="413" y="623.0591">EnsureUniqueSerialNumber()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120" x="413" y="638.1919">CheckCredProofs()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133" x="413" y="653.3247">ResetAliceDeadline()</text><polygon fill="#A80036" points="932.5,687.5234,942.5,691.5234,932.5,695.5234,936.5,691.5234" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="397.5" x2="938.5" y1="691.5234" y2="691.5234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89" x="404.5" y="686.4575">Creds[] (zero)</text><polygon fill="#A80036" points="413.5,716.6563,403.5,720.6563,413.5,724.6563,409.5,720.6563" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="407.5" x2="1015" y1="720.6563" y2="720.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="497" x="419.5" y="715.5903">POST inputs-registration: RoundId, (Input, RoundParamSig)[], ZeroCredReqs[]</text><path d="M407,733.6563 L407,924.6563 L596,924.6563 L596,743.6563 L586,733.6563 L407,733.6563 " fill="#FBFB77" filter="url(#fqyzb78sj8d8t)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M586,733.6563 L586,743.6563 L596,743.6563 L586,733.6563 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100" x="413" y="750.7231">IsRoundFound()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="168" x="413" y="765.856">IsInputRegistrationPhase()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="413" y="780.9888">AllUnspent()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92" x="413" y="796.1216">AllConfirmed()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69" x="413" y="811.2544">AllMature()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="119" x="413" y="826.3872">AllStandardScript()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="413" y="841.52">AllNotMalleable()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="158" x="413" y="856.6528">CheckRoundParamSigs()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164" x="413" y="871.7856">AllAllowedIfBlameRound()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95" x="413" y="886.9185">AllNotBanned()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156" x="413" y="902.0513">UpdateIfDuplicateInput()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117" x="413" y="917.1841">SetAliceDeadline()</text><polygon fill="#A80036" points="1004,951.3828,1014,955.3828,1004,959.3828,1008,955.3828" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="397.5" x2="1010" y1="955.3828" y2="955.3828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127" x="404.5" y="950.3169">AliceId, ZeroCreds[]</text><rect fill="#EEEEEE" filter="url(#fqyzb78sj8d8t)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1191.5" x="0" y="983.9492"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1191.5" y1="983.9492" y2="983.9492"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1191.5" y1="986.9492" y2="986.9492"/><rect fill="#EEEEEE" filter="url(#fqyzb78sj8d8t)" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="211" x="490.25" y="973.3828"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="192" x="496.25" y="989.4497">Connection Confirmation</text><polygon fill="#A80036" points="413.5,1023.6484,403.5,1027.6484,413.5,1031.6484,409.5,1027.6484" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="407.5" x2="943.5" y1="1027.6484" y2="1027.6484"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="523" x="419.5" y="1022.5825">POST connection-confirmation: RoundId, AliceId, RealCredReqs[], ZeroCredReqs[]</text><path d="M407,1040.6484 L407,1125.6484 L766,1125.6484 L766,1050.6484 L756,1040.6484 L407,1040.6484 " fill="#FBFB77" filter="url(#fqyzb78sj8d8t)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M756,1040.6484 L756,1050.6484 L766,1050.6484 L756,1040.6484 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100" x="413" y="1057.7153">IsRoundFound()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="338" x="413" y="1072.8481">IsInputRegistrationOrConnectionConfirmationPhase()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89" x="413" y="1087.981">IsAliceFound()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="184" x="413" y="1103.1138">EnsureUniqueSerialNumber()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120" x="413" y="1118.2466">CheckCredProofs()</text><polygon fill="#A80036" points="932.5,1152.4453,942.5,1156.4453,932.5,1160.4453,936.5,1156.4453" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="397.5" x2="938.5" y1="1156.4453" y2="1156.4453"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="85" x="404.5" y="1151.3794">Creds[] (real)</text><polygon fill="#A80036" points="413.5,1181.5781,403.5,1185.5781,413.5,1189.5781,409.5,1185.5781" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="407.5" x2="1015" y1="1185.5781" y2="1185.5781"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="523" x="419.5" y="1180.5122">POST connection-confirmation: RoundId, AliceId, RealCredReqs[], ZeroCredReqs[]</text><path d="M407,1198.5781 L407,1283.5781 L766,1283.5781 L766,1208.5781 L756,1198.5781 L407,1198.5781 " fill="#FBFB77" filter="url(#fqyzb78sj8d8t)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M756,1198.5781 L756,1208.5781 L766,1208.5781 L756,1198.5781 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100" x="413" y="1215.645">IsRoundFound()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="338" x="413" y="1230.7778">IsInputRegistrationOrConnectionConfirmationPhase()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89" x="413" y="1245.9106">IsAliceFound()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="184" x="413" y="1261.0435">EnsureUniqueSerialNumber()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120" x="413" y="1276.1763">CheckCredProofs()</text><polygon fill="#A80036" points="1004,1310.375,1014,1314.375,1004,1318.375,1008,1314.375" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="397.5" x2="1010" y1="1314.375" y2="1314.375"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="85" x="404.5" y="1309.3091">Creds[] (real)</text><polygon fill="#A80036" points="380.5,1339.5078,390.5,1343.5078,380.5,1347.5078,384.5,1343.5078" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="57.5" x2="386.5" y1="1343.5078" y2="1343.5078"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="316" x="64.5" y="1338.4419">POST credential-reissuance: RoundId, CredReqs[]</text><path d="M407,1356.5078 L407,1426.5078 L810,1426.5078 L810,1366.5078 L800,1356.5078 L407,1356.5078 " fill="#FBFB77" filter="url(#fqyzb78sj8d8t)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M800,1356.5078 L800,1366.5078 L810,1366.5078 L800,1356.5078 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100" x="413" y="1373.5747">IsRoundFound()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="382" x="413" y="1388.7075">IsInputConnectionConfirmationOrOutputRegistrationPhase()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="184" x="413" y="1403.8403">EnsureUniqueSerialNumber()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120" x="413" y="1418.9731">CheckCredProofs()</text><polygon fill="#A80036" points="68.5,1453.1719,58.5,1457.1719,68.5,1461.1719,64.5,1457.1719" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="62.5" x2="396.5" y1="1457.1719" y2="1457.1719"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="47" x="74.5" y="1452.106">Creds[]</text><rect fill="#EEEEEE" filter="url(#fqyzb78sj8d8t)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1191.5" x="0" y="1485.7383"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1191.5" y1="1485.7383" y2="1485.7383"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1191.5" y1="1488.7383" y2="1488.7383"/><rect fill="#EEEEEE" filter="url(#fqyzb78sj8d8t)" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="173" x="509.25" y="1475.1719"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="154" x="515.25" y="1491.2388">Output Registration</text><polygon fill="#A80036" points="413.5,1525.4375,403.5,1529.4375,413.5,1533.4375,409.5,1529.4375" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="407.5" x2="1079" y1="1529.4375" y2="1529.4375"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="391" x="419.5" y="1524.3716">POST output-registration: RoundId, Output, PresentedCreds[]</text><path d="M407,1542.4375 L407,1627.4375 L612,1627.4375 L612,1552.4375 L602,1542.4375 L407,1542.4375 " fill="#FBFB77" filter="url(#fqyzb78sj8d8t)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M602,1542.4375 L602,1552.4375 L612,1552.4375 L602,1542.4375 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100" x="413" y="1559.5044">IsRoundFound()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180" x="413" y="1574.6372">IsOutputRegistrationPhase()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114" x="413" y="1589.77">IsStandardScript()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="184" x="413" y="1604.9028">EnsureUniqueSerialNumber()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120" x="413" y="1620.0356">CheckCredProofs()</text><polygon fill="#A80036" points="1068,1654.2344,1078,1658.2344,1068,1662.2344,1072,1658.2344" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="397.5" x2="1074" y1="1658.2344" y2="1658.2344"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="175" x="404.5" y="1653.1685">UnsignedTransactionSecret</text><rect fill="#EEEEEE" filter="url(#fqyzb78sj8d8t)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1191.5" x="0" y="1686.8008"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1191.5" y1="1686.8008" y2="1686.8008"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1191.5" y1="1689.8008" y2="1689.8008"/><rect fill="#EEEEEE" filter="url(#fqyzb78sj8d8t)" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="169" x="511.25" y="1676.2344"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="150" x="517.25" y="1692.3013">Transaction Signing</text><polygon fill="#A80036" points="380.5,1726.5,390.5,1730.5,380.5,1734.5,384.5,1730.5" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="57.5" x2="386.5" y1="1730.5" y2="1730.5"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118" x="64.5" y="1725.4341">coordinator-status</text><polygon fill="#A80036" points="68.5,1755.6328,58.5,1759.6328,68.5,1763.6328,64.5,1759.6328" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="62.5" x2="396.5" y1="1759.6328" y2="1759.6328"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107" x="74.5" y="1754.5669">RoundStatuses[]</text><polygon fill="#A80036" points="413.5,1784.7656,403.5,1788.7656,413.5,1792.7656,409.5,1788.7656" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="407.5" x2="943.5" y1="1788.7656" y2="1788.7656"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="421" x="419.5" y="1783.6997">POST transaction-signatures: RoundId, AliceId, (Input, Signature)[]</text><path d="M407,1801.7656 L407,1886.7656 L608,1886.7656 L608,1811.7656 L598,1801.7656 L407,1801.7656 " fill="#FBFB77" filter="url(#fqyzb78sj8d8t)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M598,1801.7656 L598,1811.7656 L608,1811.7656 L598,1801.7656 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100" x="413" y="1818.8325">IsRoundFound()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180" x="413" y="1833.9653">IsTransactionSigningPhase()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89" x="413" y="1849.0981">IsAliceFound()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="149" x="413" y="1864.231">CheckInputSignatures()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156" x="413" y="1879.3638">UpdateIfAlreadySigned()</text><polygon fill="#A80036" points="932.5,1913.5625,942.5,1917.5625,932.5,1921.5625,936.5,1917.5625" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="397.5" x2="938.5" y1="1917.5625" y2="1917.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="26" x="404.5" y="1912.4966">ACK</text><polygon fill="#A80036" points="413.5,1942.6953,403.5,1946.6953,413.5,1950.6953,409.5,1946.6953" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="407.5" x2="1015" y1="1946.6953" y2="1946.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="421" x="419.5" y="1941.6294">POST transaction-signatures: RoundId, AliceId, (Input, Signature)[]</text><path d="M407,1959.6953 L407,2044.6953 L608,2044.6953 L608,1969.6953 L598,1959.6953 L407,1959.6953 " fill="#FBFB77" filter="url(#fqyzb78sj8d8t)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M598,1959.6953 L598,1969.6953 L608,1969.6953 L598,1959.6953 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100" x="413" y="1976.7622">IsRoundFound()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180" x="413" y="1991.895">IsTransactionSigningPhase()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89" x="413" y="2007.0278">IsAliceFound()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="149" x="413" y="2022.1606">CheckInputSignatures()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156" x="413" y="2037.2935">UpdateIfAlreadySigned()</text><polygon fill="#A80036" points="1004,2071.4922,1014,2075.4922,1004,2079.4922,1008,2075.4922" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="397.5" x2="1010" y1="2075.4922" y2="2075.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="26" x="404.5" y="2070.4263">ACK</text><rect fill="#EEEEEE" filter="url(#fqyzb78sj8d8t)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1191.5" x="0" y="2104.0586"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1191.5" y1="2104.0586" y2="2104.0586"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1191.5" y1="2107.0586" y2="2107.0586"/><rect fill="#EEEEEE" filter="url(#fqyzb78sj8d8t)" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="216" x="487.75" y="2093.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="197" x="493.75" y="2109.5591">Transaction Broadcasting</text><polygon fill="#A80036" points="1101.5,2143.7578,1111.5,2147.7578,1101.5,2151.7578,1105.5,2147.7578" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="397.5" x2="1107.5" y1="2147.7578" y2="2147.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118" x="404.5" y="2142.6919">SignedTransaction</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="67" x="1113.5" y="2185.6201">Mempool</text><path d="M1132,2136.625 C1132,2126.625 1150,2126.625 1150,2126.625 C1150,2126.625 1168,2126.625 1168,2136.625 L1168,2162.625 C1168,2172.625 1150,2172.625 1150,2172.625 C1150,2172.625 1132,2172.625 1132,2162.625 L1132,2136.625 " fill="#FEFECE" filter="url(#fqyzb78sj8d8t)" style="stroke:#000000;stroke-width:1.5;"/><path d="M1132,2136.625 C1132,2146.625 1150,2146.625 1150,2146.625 C1150,2146.625 1168,2146.625 1168,2136.625 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><polygon fill="#A80036" points="380.5,2216.0547,390.5,2220.0547,380.5,2224.0547,384.5,2220.0547" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="57.5" x2="386.5" y1="2220.0547" y2="2220.0547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118" x="64.5" y="2214.9888">coordinator-status</text><polygon fill="#A80036" points="68.5,2245.1875,58.5,2249.1875,68.5,2253.1875,64.5,2249.1875" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="62.5" x2="396.5" y1="2249.1875" y2="2249.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107" x="74.5" y="2244.1216">RoundStatuses[]</text><!--MD5=[c936852debc1b7c7ac2ae168ebc5ac7a]
@startuml
collections Anonymous
participant Coordinator
participant Alice1
participant Alice2
participant Bob
database Mempool

title Scenario: A Participant Is Consolidating 2 Coins (Alice1, Alice2) Into 1 (Bob) with a fake reissuance request \n

== Input Registration ==

Anonymous -> Coordinator ++ : GET coordinator-status
return RoundStatuses[]

Alice1 -> Coordinator ++: POST inputs-registration: RoundId, (Input, RoundParamSig)[], ZeroCredReqs[]
note right of Coordinator
    IsRoundFound()
    IsInputRegistrationPhase()
    AllUnspent()
    AllConfirmed()
    AllMature()
    AllStandardScript()
    AllNotMalleable()
    CheckRoundParamSigs()
    AllAllowedIfBlameRound()
    AllNotBanned()
    UpdateIfDuplicateInput()
    SetAliceDeadline()
end note
return AliceId, ZeroCreds[]
...

Alice1 -> Coordinator ++: POST connection-confirmation: RoundId, AliceId, RealCredReqs[], ZeroCredReqs[]
note right of Coordinator
    IsRoundFound()
    IsInputRegistrationOrConnectionConfirmationPhase()
    IsAliceFound()
    EnsureUniqueSerialNumber()
    CheckCredProofs()
    ResetAliceDeadline()
end note
return Creds[] (zero)

Alice2 -> Coordinator ++: POST inputs-registration: RoundId, (Input, RoundParamSig)[], ZeroCredReqs[]
note right of Coordinator
    IsRoundFound()
    IsInputRegistrationPhase()
    AllUnspent()
    AllConfirmed()
    AllMature()
    AllStandardScript()
    AllNotMalleable()
    CheckRoundParamSigs()
    AllAllowedIfBlameRound()
    AllNotBanned()
    UpdateIfDuplicateInput()
    SetAliceDeadline()
end note
return AliceId, ZeroCreds[]

== Connection Confirmation ==

Alice1 -> Coordinator ++: POST connection-confirmation: RoundId, AliceId, RealCredReqs[], ZeroCredReqs[]
note right of Coordinator
    IsRoundFound()
    IsInputRegistrationOrConnectionConfirmationPhase()
    IsAliceFound()
    EnsureUniqueSerialNumber()
    CheckCredProofs()
end note
return Creds[] (real)

Alice2 -> Coordinator ++: POST connection-confirmation: RoundId, AliceId, RealCredReqs[], ZeroCredReqs[]
note right of Coordinator
    IsRoundFound()
    IsInputRegistrationOrConnectionConfirmationPhase()
    IsAliceFound()
    EnsureUniqueSerialNumber()
    CheckCredProofs()
end note
return Creds[] (real)

Anonymous -> Coordinator ++: POST credential-reissuance: RoundId, CredReqs[]
note right of Coordinator
    IsRoundFound()
    IsInputConnectionConfirmationOrOutputRegistrationPhase()
    EnsureUniqueSerialNumber()
    CheckCredProofs()
end note
return Creds[]

== Output Registration ==

Bob -> Coordinator ++: POST output-registration: RoundId, Output, PresentedCreds[]
note right of Coordinator
    IsRoundFound()
    IsOutputRegistrationPhase()
    IsStandardScript()
    EnsureUniqueSerialNumber()
    CheckCredProofs()
end note
return UnsignedTransactionSecret

== Transaction Signing ==

Anonymous -> Coordinator ++ : coordinator-status
return RoundStatuses[]

Alice1 -> Coordinator ++: POST transaction-signatures: RoundId, AliceId, (Input, Signature)[]
note right of Coordinator
    IsRoundFound()
    IsTransactionSigningPhase()
    IsAliceFound()
    CheckInputSignatures()
    UpdateIfAlreadySigned()
end note
return ACK

Alice2 -> Coordinator ++: POST transaction-signatures: RoundId, AliceId, (Input, Signature)[]
note right of Coordinator
    IsRoundFound()
    IsTransactionSigningPhase()
    IsAliceFound()
    CheckInputSignatures()
    UpdateIfAlreadySigned()
end note
return ACK

== Transaction Broadcasting ==

Coordinator -> Mempool**  : SignedTransaction

Anonymous -> Coordinator ++ : coordinator-status
return RoundStatuses[]
@enduml

PlantUML version 1.2021.2beta2(Unknown compile time)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>